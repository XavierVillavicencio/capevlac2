!function(e){function n(n){const t=this,i=e.extend({},n),s=e(".assignment-countdown .progress-number"),a=new LP.Event_Callback(this);let o=i.remainingTime,l=null;function r(){l&&clearTimeout(l)}function m(e,n){a.callEvent("tick",[n]),n<=0&&(r(),a.callEvent("finish"))}this.on=a.on,this.off=a.off,i.totalTime>0&&(this.on("tick.showTime",(function(){o<0&&(o=0),void 0!==i&&s.html(o.AssignmenttoTime(i))})),this.on("finish.submit",(function(){e("form.save-assignment").trigger("submit")}))),this.getRemainingTime=function(){return o},i.onTick&&t.on("tick",i.onTick),i.onFinish&&t.on("finish",i.onFinish),i.watchChange("remainingTime",(function(e,n,i){return o=i,m.apply(t,[n,i]),i})),function t(){r();const s=i.remainingTime<=0;if(-1===n.status.indexOf("finished"))if(s){if(e("form.save-assignment").off("submit.learn-press-confirm"),n.uploaded)return;a.callEvent("finish")}else i.remainingTime--,l=setTimeout(t,1e3)}()}!Number.prototype.AssignmenttoTime&&(Number.prototype.AssignmenttoTime=function(e){let n=this+0,t="",i=" day left",s=" days left";if(void 0!==e.singularDayText&&(i=e.singularDayText),void 0!==e.pluralDayText&&(s=e.pluralDayText),n>86400){const e=Math.ceil(n/86400);t=e+(e>1?s:i)}else{let e=Math.floor(n/3600),i=0;n=e?n%(3600*e):n,i=Math.floor(n/60),n=i?n%(60*i):n,e&&e<10&&(e="0"+e),i<10&&(i="0"+i),n<10&&(n="0"+n),t=e+":"+i+":"+n}return t}),e(document).ready((function(){if("undefined"!=typeof lpAssignmentSettings&&e(".assignment-countdown").length>0&&(window.lpAssignment=new n(lpAssignmentSettings)),e(".save-assignment").length>0){let n;e("button").on("click",(function(){n=e(this).attr("id")})),e(".save-assignment").on("submit",(function(t){let i=document.getElementById("_lp_upload_file");if(i){let n=~~e("#assignment-file-amount-allow").text(),t=~~e("#assignment-file-amount-allow").attr("max-file-size");if(i.files.length>n)return alert("Maximum amount of files you can upload more: "+n),!1;{let e=!1;for(let n=0;n<i.files.length;n++)i.files[n].size>1024*t*1024&&(e=!0);if(e)return alert("File size must be less than "+t+" MB"),!1}}if("assignment-button-right"==n){const n=e("#assignment-button-right").data("confirm");return!!confirm(n)||(t.preventDefault(),!1)}if("assignment-button-left"==n){const n=e("#assignment-button-left").data("confirm");return!!confirm(n)||(t.preventDefault(),!1)}return e(this).append('<input type="hidden" name="controls-button" value="Send" /> '),!0}))}e(".assignment_action_icon").on("click",(function(){const n=e(this).attr("order"),t=e(this).data("confirm");e(".lp-assignment-buttons .learn-press-message").remove();const i=confirm(t),s=e(this).closest("form.save-assignment").find('input[name="assignment-id"]').val();if(!i)return!1;{const t=e("#assignment-file-amount-allow").text();e.ajax({type:"post",url:lpAssignmentSettings.root+"learnpress/v1/assignments/delete-submit-file",beforeSend(n){n.setRequestHeader("X-WP-Nonce",lpAssignmentSettings.nonce),e(".assignmen-file").append('<div class="lp-assignment__overlay"></div>')},data:{id:s,fileId:n},success(i){if(200==i.data.status){e(".lp-assignment__overlay").remove();const s=parseInt(t)+1;e("#assignment-uploaded-file-"+n).hide(),e("#_lp_upload_file").prop("disabled",!1),e("#assignment-file-amount-allow").text(s),e(".learn-press-assignment-uploaded").before('<div class="learn-press-message success" style="float:left; width:100%; margin-top:10px "> '+i.message+"</div>").fadeIn(slow)}else e(".lp-assignment__overlay").remove(),e(".learn-press-assignment-uploaded").before('<div class="learn-press-message error" style="float:left; width:100%; margin-top:10px "> '+i.message+"</div>")}})}}))}))}(jQuery);